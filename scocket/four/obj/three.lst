Microsoft (R) Macro Assembler Version 6.11		    10/26/23 17:47:18
three.asm						     Page 1 - 1


				.model small       
				.486  ;; 486 Ö¸Áî¼¯
				;; cs0 -->> 0809.cs
				;; cs1 -->> 8255.cs

 = 0270				t0 equ 270h
 = 0273				tkz equ 273h


 = 0202				in3_0809 equ 202h
 = 0210				pa_8255 equ 210h
 = 0211				pb_8255 equ 211h
 = 0212				pc_8255 equ 212h
 = 0213				kz_8255 equ 213h

				;pc_8255 equ 212h

 0000				data  segment
 0000 3F 06 5B 4F 66 6D			leds DB 3FH,06H,5BH,4FH,66H,6DH,7DH,07H,7FH,67H
       7D 07 7F 67
 000A  77 7C 39 5E 79 71			DB 77H,7CH,39H,5EH,79H,71H
 0010 00				n	db 0
 0011 00				d1	db 0
 0012 00				d0	db 0
 0013				data ends

 0000				code  segment
				assume cs:code, ds:data
 0000				start:	
					;mov dx, tkz
					;mov al, 00110110b
					;out dx, al
					;mov dx, t0
					;mov ax, 100
					;out dx, al
					;mov al, ah
					;out dx, al

 0000  B8 ---- R		    mov ax, data  ;; if use data
three.asm(38): warning A4012: line number information for segment without class 'CODE' : code
 0003  8E D8			    mov ds, ax
 0005  E8 0017			    call init8255
 0008				again:
 0008  E8 001B			    call start0809
 000B  E8 001D			    call check0809Eoc
 000E  E8 0023			   	call read0809
				   	
 0011  A2 0010 R			mov n, al
					
 0014  B9 03E8				mov cx, 1000
 0017				lp:
 0017  E2 FE				loop lp
					
 0019  E8 001D			   	call delay
				   ; call display
				    
 001C  EB EA				jmp again
 001E  F4			  	hlt

 001F				init8255 proc
 001F  BA 0213				mov dx, kz_8255
 0022  B0 81				mov al,10000001b;
 0024  EE				out dx, al
 0025  C3				ret
 0026				init8255 endp

 0026				start0809 proc
 0026  BA 0202				mov dx, in3_0809
 0029  EE				out dx, al
 002A  C3				ret
 002B				start0809 endp

 002B				check0809Eoc proc
 002B  BA 0212				mov dx, pc_8255
 002E				ag_check:
 002E  EC				in al, dx
 002F  A8 01				test al, 01h
 0031  74 FB				jz ag_check
 0033  C3				ret
 0034				check0809Eoc endp

 0034				read0809 proc
 0034  BA 0202				mov dx, in3_0809
 0037  EC				in al, dx
 0038  C3				ret
 0039				read0809 endp

 0039				delay proc
					
 0039  A0 0010 R			mov al, n
 003C  C0 E0 04				shl al, 4
 003F  C0 E8 04				shr al, 4
 0042  A2 0012 R			mov d0, al
					
 0045  A0 0010 R			mov al,n
 0048  C0 E8 04				shr al, 4
 004B  A2 0011 R			mov d1, al
 004E  B9 7530				mov cx, 30000
 0051				agde:
 0051  E8 0012				call display
 0054  E2 FB				loop agde
 0056				delay endp

				;delay proc
				;	mov bx, 10
				;	call setTimer ;; mode = 0
				;again3s:
				;	call display

				;	mov dx, pc_8255
				;	in al, dx
				;	test al, 01h
				;	jz again3s
					;ret
				;delay endp
				  	
 0056				setTimer proc
 0056  BA 0273				mov dx, tkz
 0059  B0 30				mov al, 00110000b
 005B  EE				out dx, al
 005C  8B C3				mov ax, bx
 005E  BA 0270				mov dx, t0
 0061  EE				out dx, al
 0062  8A C4				mov al, ah
 0064  EE				out dx, al
 0065  C3				ret
 0066				setTimer endp


 0066				display proc
 0066  33 C0			  	xor ax,ax	
				  	
 0068  A0 0012 R			mov al,d0
 006B  BB 0000 R			mov bx,offset leds
 006E  D7				xlat  
 006F  BA 0210				mov dx,pa_8255
 0072  EE				out dx,al
 0073  B0 40				mov al,01000000B
 0075  BA 0212				mov dx,pc_8255
 0078  EE				out dx,al
 0079  B0 00				mov al,0
 007B  EE				out dx,al
					
 007C  A0 0011 R			mov al,d1
 007F  BB 0000 R			mov bx,offset leds
 0082  D7				xlat 
 0083  BA 0210				mov dx,pa_8255
 0086  EE				out dx,al
 0087  B0 80				mov al,10000000B
 0089  BA 0212				mov dx,pc_8255
 008C  EE				out dx,al
 008D  B0 00				mov al,0
 008F  EE				out dx,al
 0090  C3				ret 
 0091				display endp 


 0091				code ends
				end start
Microsoft (R) Macro Assembler Version 6.11		    10/26/23 17:47:18
three.asm						     Symbols 2 - 1




Segments and Groups:

                N a m e                 Size     Length   Align   Combine Class

DGROUP . . . . . . . . . . . . .	GROUP
_DATA  . . . . . . . . . . . . .	16 Bit	 0000	  Word	  Public  'DATA'	
_TEXT  . . . . . . . . . . . . .	16 Bit	 0000	  Word	  Public  'CODE'	
code . . . . . . . . . . . . . .	16 Bit	 0091	  Para	  Private 
data . . . . . . . . . . . . . .	16 Bit	 0013	  Para	  Private 


Procedures,  parameters and locals:

                N a m e                 Type     Value    Attr

check0809Eoc . . . . . . . . . .	P Near	 002B	  code	Length= 0009 Private
delay  . . . . . . . . . . . . .	P Near	 0039	  code	Length= 001D Private
display  . . . . . . . . . . . .	P Near	 0066	  code	Length= 002B Private
init8255 . . . . . . . . . . . .	P Near	 001F	  code	Length= 0007 Private
read0809 . . . . . . . . . . . .	P Near	 0034	  code	Length= 0005 Private
setTimer . . . . . . . . . . . .	P Near	 0056	  code	Length= 0010 Private
start0809  . . . . . . . . . . .	P Near	 0026	  code	Length= 0005 Private


Symbols:

                N a m e                 Type     Value    Attr

@CodeSize  . . . . . . . . . . .	Number	 0000h	 
@DataSize  . . . . . . . . . . .	Number	 0000h	 
@Interface . . . . . . . . . . .	Number	 0000h	 
@Model . . . . . . . . . . . . .	Number	 0002h	 
@code  . . . . . . . . . . . . .	Text   	 _TEXT
@data  . . . . . . . . . . . . .	Text   	 DGROUP
@fardata?  . . . . . . . . . . .	Text   	 FAR_BSS
@fardata . . . . . . . . . . . .	Text   	 FAR_DATA
@stack . . . . . . . . . . . . .	Text   	 DGROUP
ag_check . . . . . . . . . . . .	L Near	 002E	  code	
again  . . . . . . . . . . . . .	L Near	 0008	  code	
agde . . . . . . . . . . . . . .	L Near	 0051	  code	
d0 . . . . . . . . . . . . . . .	Byte	 0012	  data	
d1 . . . . . . . . . . . . . . .	Byte	 0011	  data	
in3_0809 . . . . . . . . . . . .	Number	 0202h	 
kz_8255  . . . . . . . . . . . .	Number	 0213h	 
leds . . . . . . . . . . . . . .	Byte	 0000	  data	
lp . . . . . . . . . . . . . . .	L Near	 0017	  code	
n  . . . . . . . . . . . . . . .	Byte	 0010	  data	
pa_8255  . . . . . . . . . . . .	Number	 0210h	 
pb_8255  . . . . . . . . . . . .	Number	 0211h	 
pc_8255  . . . . . . . . . . . .	Number	 0212h	 
start  . . . . . . . . . . . . .	L Near	 0000	  code	
t0 . . . . . . . . . . . . . . .	Number	 0270h	 
tkz  . . . . . . . . . . . . . .	Number	 0273h	 

	   1 Warnings
	   0 Errors
